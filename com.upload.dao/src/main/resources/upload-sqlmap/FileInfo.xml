<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
	"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.upload.dao.FileInfoDao">
<sql id="limit">
	<if test="startRow != null and endRow !=null">limit #{startRow},#{endRow}</if>
</sql>	
<sql id="orderCondition">
	<if test="orderColumn != null and orderColumn != ''">ORDER BY $orderColumn </if>
</sql>

<sql id="Condition">
	<where>
		<if test="id != null "><![CDATA[AND id =#{id}]]></if>		
		<if test="name != null "><![CDATA[AND name =#{name}]]></if>		
		<if test="path != null "><![CDATA[AND path =#{path}]]></if>		
		<if test="size != null "><![CDATA[AND size =#{size}]]></if>		
		<if test="createTime != null "><![CDATA[AND create_time =#{createTime}]]></if>		
		<if test="updateTime != null "><![CDATA[AND update_time =#{updateTime}]]></if>
		<if test="delStatus != null "><![CDATA[AND del_status =#{delStatus}]]></if>
	</where>
</sql>
<sql id="columns">
	id as id ,name as name ,path as path ,size as size ,create_time as createTime ,update_time as updateTime ,del_status as delStatus
</sql>
<insert id="insert" parameterType="FileInfo" >
  	insert into file_info
  	(id,name,path,size,create_time,update_time,del_status)
  	values
  	(#{id},#{name},#{path},#{size},#{createTime},#{updateTime},#{delStatus})
  	<selectKey keyProperty="id" resultType="long" order="AFTER">
	select last_insert_id() 
</selectKey> 
</insert>

<delete id="del" parameterType="long">  
        delete from file_info where id = #{id}
</delete> 
  
<update id="update" parameterType="FileInfo">
	update file_info 
  	<set>
  				<if test="name != null "><![CDATA[ name =#{name},]]></if>		
  				<if test="path != null "><![CDATA[ path =#{path},]]></if>		
  				<if test="size != null "><![CDATA[ size =#{size},]]></if>		
  				<if test="createTime != null "><![CDATA[ create_time =#{createTime},]]></if>		
  				<if test="updateTime != null "><![CDATA[ update_time =#{updateTime},]]></if>		
  				<if test="delStatus != null "><![CDATA[ del_status =#{delStatus},]]></if>
  	</set> 
    where  id=#{id}
  </update> 
  <select id="queryCount" parameterType="FileInfo" resultType="int">
        select count(1) from file_info 
        <include refid="Condition"/>
  </select> 
  <select id="query" parameterType="FileInfo" resultType="FileInfo">
        select 
         <include refid="columns"/>
		from file_info 
        <include refid="Condition"/>
        <include refid="limit"/>        
  </select> 
  </mapper>
